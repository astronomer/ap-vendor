version: "3.9"

services:
  ap-alertmanager:
    image: ap-alertmanager
    build:
      context: alertmanager

  ap-awsesproxy:
    image: ap-awsesproxy
    build:
      context: awsesproxy
    ports:
      - 9200:9200
    entrypoint: "top"

  ap-blackbox-exporter:
    image: ap-blackbox-exporter
    build:
      context: blackbox-exporter
    ports:
      - 9115:9115

  ap-configmap-reloader:
    image: ap-configmap-reloader
    build:
      context: configmap-reloader

  ap-curator:
    image: ap-curator
    build:
      context: curator

  ap-dind-golang:
    image: ap-dind-golang
    build:
      context: dind-golang
    entrypoint: "top"

  ap-elasticsearch:
    image: ap-elasticsearch
    build:
      context: elasticsearch

  ap-elasticsearch-exporter:
    image: ap-elasticsearch-exporter
    build:
      context: elasticsearch-exporter

  ap-fluentd:
    image: ap-fluentd
    build:
      context: fluentd

  ap-git-daemon:
    image: ap-git-daemon
    build:
      context: git-daemon
    entrypoint: "top"

  ap-git-sync:
    image: ap-git-sync
    build:
      context: git-sync

  ap-grafana:
    image: ap-grafana
    build:
      context: grafana

  ap-keda:
    image: ap-keda
    build:
      context: keda

  ap-keda-metrics-apiserver:
    image: ap-keda-metrics-apiserver
    build:
      context: keda-metrics-apiserver

  ap-kibana:
    image: ap-kibana
    build:
      context: kibana

  ap-kube-state:
    image: ap-kube-state
    build:
      context: kube-state

  ap-kubed:
    image: ap-kubed
    build:
      context: kubed

  ap-nats-exporter:
    image: ap-nats-exporter
    build:
      context: nats-exporter
    entrypoint: "top"

  ap-nats-server:
    image: ap-nats-server
    build:
      context: nats-server

  ap-nats-streaming:
    image: ap-nats-streaming
    build:
      context: nats-streaming

  ap-nginx:
    image: ap-nginx
    build:
      context: nginx
    entrypoint: "top"

  ap-nginx-es:
    image: ap-nginx-es
    build:
      context: nginx-es

  ap-node-exporter:
    image: ap-node-exporter
    build:
      context: node-exporter

  ap-openresty:
    image: ap-openresty
    build:
      context: openresty

  ap-pgbouncer:
    image: ap-pgbouncer
    build:
      context: pgbouncer

  ap-pgbouncer-exporter:
    image: ap-pgbouncer-exporter
    build:
      context: pgbouncer-exporter
    entrypoint: "top"

  ap-postgres-exporter:
    image: ap-postgres-exporter
    build:
      context: postgres-exporter

  ap-postgresql:
    image: ap-postgresql:${ASTRO_IMAGE_TAG:-latest}
    build:
      context: postgresql
    environment:
      - ALLOW_EMPTY_PASSWORD=yes
